configuration = application.configuration("nabu.web.core.types.passwordProtect")

if (configuration != null && configuration/password != null)
	@cookie password-protection
	password ?= null
	
	if (password != hash("MD5", configuration/password))
		response.header("Original-Target", request.target())
		response.target("password-protect")